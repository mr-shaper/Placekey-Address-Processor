# 🌐 Web界面使用指南

## 概述

地址公寓识别与门禁码提取工具提供了友好的Web界面，让您可以通过浏览器轻松处理CSV文件，无需使用命令行。

## 🚀 快速启动

### 1. 环境准备

```bash
# 确保已安装依赖
pip install -r requirements.txt

# 配置环境变量（推荐）
cp config/.env.example .env
# 编辑.env文件添加API密钥和Web配置
```

### 2. 启动Web服务

```bash
# 启动Web服务
python ui/app.py

# 或者使用Flask命令
export FLASK_APP=ui/app.py
flask run --port=5001
```

### 3. 访问界面

启动成功后，在浏览器中访问：
```
http://localhost:5001
```

## 📋 界面功能介绍

### 1. 主页面布局
- **导航栏**: 包含主要功能入口和系统状态
- **文件上传区**: 支持拖拽和点击上传CSV文件
- **配置面板**: API密钥配置和处理参数设置
- **结果展示区**: 实时显示处理进度和结果

### 2. 文件上传功能
- **拖拽上传**: 直接将CSV文件拖拽到上传区域
- **点击上传**: 点击上传按钮选择文件
- **格式验证**: 自动检查文件格式和必要字段
- **模板下载**: 提供标准CSV模板下载

**支持的文件格式**:
- CSV文件（.csv）
- 最大文件大小：16MB
- 编码：UTF-8（推荐）

### 3. 配置面板
- **API密钥管理**: 安全输入和验证Placekey API密钥
- **处理参数**: 调整并发数、批次大小、超时设置
- **列名映射**: 可视化配置中文列名映射关系
- **输出选项**: 选择输出字段和格式

### 4. 处理结果
- **实时进度**: 动态显示处理进度条和详细状态
- **结果预览**: 分页预览处理结果，支持搜索和筛选
- **统计报告**: 详细的处理统计、成功率和错误分析
- **多格式下载**: 支持CSV、JSON等多种格式下载
- **历史记录**: 查看和管理历史处理记录

## 📋 使用步骤

### 步骤1: 上传CSV文件

上传成功后，系统会显示：
- 文件基本信息（文件名、总行数）
- 前5行数据预览
- 列名信息

### 步骤2: 配置处理参数

根据需要调整：
- API密钥设置
- 处理并发数
- 列名映射关系

### 步骤3: 处理数据

点击"开始处理"按钮，系统将：
1. 自动识别地址列
2. 提取公寓信息和门禁码
3. 生成处理统计信息

### 步骤4: 下载结果

处理完成后：
- 查看处理统计（总记录数、公寓地址数等）
- 点击"下载结果文件"获取处理后的CSV

## 🔧 功能特性

### 智能识别
- **自动列检测**: 自动识别包含地址信息的列
- **多格式支持**: 支持中英文地址格式
- **公寓类型识别**: 识别各种公寓单元格式

### 数据处理
- **批量处理**: 一次处理整个CSV文件
- **实时预览**: 上传后立即预览数据结构
- **错误处理**: 友好的错误提示和处理

### 结果输出
- **增强数据**: 原始数据 + 提取的门禁码
- **统计信息**: 处理结果的详细统计
- **即时下载**: 处理完成后立即可下载

## 📊 输出字段说明

处理后的CSV文件将包含以下新增字段：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `access_code` | 提取的门禁码 | `1234`, `A-101` |
| `is_apartment` | 是否为公寓地址 | `true`, `false` |
| `confidence` | 识别置信度 | `high`, `medium`, `low` |
| `unit_type` | 单元类型 | `apartment`, `suite`, `unit` |

## ⚙️ 配置说明

### API配置状态

Web界面会显示当前的配置状态：

- **✅ API配置正常**: 已配置Placekey API，可使用完整功能
- **⚠️ 未配置API**: 未配置API密钥，使用基础功能

### 环境变量配置

如需使用完整功能，请配置以下环境变量：

```bash
# 在项目根目录创建 .env 文件
echo "PLACEKEY_API_KEY=your_api_key_here" > .env
```

## 🛠️ 故障排除

### 常见问题

**1. 文件上传失败**
- 检查文件格式是否为CSV
- 确认文件大小不超过16MB
- 检查文件编码是否为UTF-8

**2. 处理失败**
- 确认CSV文件包含地址信息列
- 检查数据格式是否正确
- 查看浏览器控制台错误信息

**3. 无法访问界面**
- 确认Web服务已启动
- 检查端口5001是否被占用
- 尝试访问 http://127.0.0.1:5001

### 日志查看

Web服务的日志会显示在启动终端中，包含：
- 请求处理信息
- 错误详情
- 性能统计

## 🔒 安全说明

- 上传的文件临时存储在系统临时目录
- 处理完成后建议及时下载并删除临时文件
- 不要上传包含敏感信息的文件到公共服务器

## 📱 浏览器兼容性

支持的浏览器：
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 🆘 获取帮助

如遇到问题，请：
1. 查看本文档的故障排除部分
2. 检查浏览器控制台错误信息
3. 查看Web服务启动日志
4. 参考项目README.md文档